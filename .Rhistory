iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
library(googleVis)
From<-c(rep("",3),rep("Significant",3),rep("Non Significant",3),rep("Dubious",3),"Significant ","Non Significant ","Dubious ")
To<-c("Significant","Non Significant","Dubious",rep(c("Significant ","Non Significant ","Dubious "),3),rep(" ",3))
Weight<-c(3359,20282,5027,1324,52,148,156,2444,378,183,412,292,9225,16113,5068)
EventGroups<-data.frame(From=From,To=To,Weight=Weight)
#lightblue, lightgreen, lightred, lightorange, lightpurple, lightyellow, darkbklue, darkgreen
ColorsSankeyNode<-c('#a6cee3', '#b2df8a', '#ed9136', '#f4f06e','#cab2d6', '#ffff99', '#1f78b4', '#33a02c','#c41f1f')
ColorsSankeyNode<-ColorsSankeyNode[c(7,2,4,3,2,4,3,9)]
ColorsSankeyNode <- paste0("[", paste0("'", ColorsSankeyNode,"'", collapse = ','), "]")
ColorsSankeyLink<-"#fb9a99"
ColorsSankeyLink <- paste0("[", paste0("'", ColorsSankeyLink,"'", collapse = ','), "]")
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ," },
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
library(googleVis)
From<-c(rep("",3),rep("Significant",3),rep("Non Significant",3),rep("Dubious",3),"Significant ","Non Significant ","Dubious ")
To<-c("Significant","Non Significant","Dubious",rep(c("Significant ","Non Significant ","Dubious "),3),rep(" ",3))
Weight<-c(3359,20282,5027,1324,52,148,156,2444,378,183,412,292,9225,16113,5068)
EventGroups<-data.frame(From=From,To=To,Weight=Weight)
#lightblue, lightgreen, lightred, lightorange, lightpurple, lightyellow, darkbklue, darkgreen
ColorsSankeyNode<-c('#a6cee3', '#b2df8a', '#fb9a99', '#f4f06e','#cab2d6', '#ffff99', '#1f78b4', '#33a02c','#c41f1f')
ColorsSankeyNode<-ColorsSankeyNode[c(7,2,4,3,2,4,3,9)]
ColorsSankeyNode <- paste0("[", paste0("'", ColorsSankeyNode,"'", collapse = ','), "]")
ColorsSankeyLink<-"#fb9a99"
ColorsSankeyLink <- paste0("[", paste0("'", ColorsSankeyLink,"'", collapse = ','), "]")
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ," },
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
library(googleVis)
From<-c(rep("",3),rep("Significant",3),rep("Non Significant",3),rep("Dubious",3),"Significant ","Non Significant ","Dubious ")
To<-c("Significant","Non Significant","Dubious",rep(c("Significant ","Non Significant ","Dubious "),3),rep(" ",3))
Weight<-c(3359,20282,5027,1324,52,148,156,2444,378,183,412,292,9225,16113,5068)
EventGroups<-data.frame(From=From,To=To,Weight=Weight)
#lightblue, lightgreen, lightred, lightorange, lightpurple, lightyellow, darkbklue, darkgreen
ColorsSankeyNode<-c('#a6cee3', '#b2df8a', '#ed9136', '#f4f06e','#cab2d6', '#ffff99', '#1f78b4', '#33a02c','#c41f1f')
ColorsSankeyNode<-ColorsSankeyNode[c(7,2,4,3,2,4,3,9)]
ColorsSankeyNode <- paste0("[", paste0("'", ColorsSankeyNode,"'", collapse = ','), "]")
ColorsSankeyLink<-"#fb9a99"
ColorsSankeyLink <- paste0("[", paste0("'", ColorsSankeyLink,"'", collapse = ','), "]")
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ," },
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
opts
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ," fontSize: 16,},
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
opts
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ,", fontSize: 16,},
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ,", fontSize: 20,},
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
list(sankey=opts,width=350)
library(googleVis)
From<-c(rep("",3),rep("Significant",3),rep("Non Significant",3),rep("Dubious",3),"Significant ","Non Significant ","Dubious ")
To<-c("Significant","Non Significant","Dubious",rep(c("Significant ","Non Significant ","Dubious "),3),rep(" ",3))
Weight<-c(3359,20282,5027,1324,52,148,156,2444,378,183,412,292,9225,16113,5068)
EventGroups<-data.frame(From=From,To=To,Weight=Weight)
#lightblue, lightgreen, lightred, lightorange, lightpurple, lightyellow, darkbklue, darkgreen
ColorsSankeyNode<-c('#a6cee3', '#b2df8a', '#ed9136', '#f4f06e','#cab2d6', '#ffff99', '#1f78b4', '#33a02c','#c41f1f')
ColorsSankeyNode<-ColorsSankeyNode[c(7,2,4,3,2,4,3,9)]
ColorsSankeyNode <- paste0("[", paste0("'", ColorsSankeyNode,"'", collapse = ','), "]")
ColorsSankeyLink<-"#fb9a99"
ColorsSankeyLink <- paste0("[", paste0("'", ColorsSankeyLink,"'", collapse = ','), "]")
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ,"},
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
library(igraph)
load("C:/Users/jpromero/Desktop/POLR3C.Rdata")
library(graph)
ftM2graphNEL(SG$Edges)
ftM2graphNEL(SG$Edges[,1:2])
ftM2graphNEL(as.matrix(SG$Edges[,1:2]))
Grafo<-ftM2graphNEL(as.matrix(SG$Edges[,1:2]))
plot(Grafo)
SG$Edges
load("Y:/JuanPablo/Prosplice/Arrays/EventsArrays.Rdata")
View(Events_HTA_Prosplice)
library(SGSeq)
BamInfo<-si
Samples<-BamInfo[,2]
PathToSamples <- system.file("extdata/bams", package = "SGSeq")
PathToGTF<-paste(system.file("extdata",package="EventPointer"),"/FBXO31.gtf",sep="")
# Run PrepareBam function
SG_RNASeq<-PrepareBam_EP(Samples=Samples,
SamplePath=PathToSamples,
Ref_Transc="GTF",
fileTransc=PathToGTF,
cores=1)
library(EventPointer)
BamInfo<-si
Samples<-BamInfo[,2]
PathToSamples <- system.file("extdata/bams", package = "SGSeq")
PathToGTF<-paste(system.file("extdata",package="EventPointer"),"/FBXO31.gtf",sep="")
# Run PrepareBam function
SG_RNASeq<-PrepareBam_EP(Samples=Samples,
SamplePath=PathToSamples,
Ref_Transc="GTF",
fileTransc=PathToGTF,
cores=1)
save(SG_RNASeq,file="C:/Users/jpromero/Desktop/SG_RNASeq.rda")
TxtPath<-system.file("extdata",package="EventPointer")
AllEvents_RNASeq<-EventDetection(SG_RNASeq,cores=1,Path=TxtPath)
AllEvents_RNASeq
save(AllEvents_RNASeq,file="C:/Users/jpromero/Desktop/AllEvents_RNASeq.rda")
SG_RNASeq
rowRanges
showMethods("rowRanges")
SG_RNASeq
TxtPath<-"C:/Users/jpromero/Desktop/"
AllEvents_RNASeq<-EventDetection(SG_RNASeq,cores=1,Path=TxtPath)
?which
library(Matrix)
showMethods("which")
library(BiocGenerics)
showMethods("which")
writeCdf
showMethods("writeCdf")
BiocInstaller::biocValid()
library(EventPointer)
data(SG_RNASeq)
SG_RNASeq
rowRanges(SG_RNASeq)
data("AllEvents_RNASeq")
AllEvents_RNASeq
data(AllEvents_RNASeq)
Dmatrix<-matrix(c(1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1),ncol=2,byrow=FALSE)
Cmatrix<-t(t(c(0,1)))
Events <- EventPointer_RNASeq(AllEvents_RNASeq,Dmatrix,Cmatrix,Statistic="LogFC",PSI=TRUE)
View(Events)
library(EventPointer)
BamInfo<-si
Samples<-BamInfo[,2]
PathToSamples <- system.file("extdata/bams", package = "SGSeq")
PathToGTF<-paste(system.file("extdata",package="EventPointer"),"/FBXO31.gtf",sep="")
SG_RNASeq<-PrepareBam_EP(Samples=Samples,
SamplePath=PathToSamples,
Ref_Transc="GTF",
fileTransc=PathToGTF,
cores=1)
library(SummarizedExperiment)
rowRanges
showMethods("rowRanges")
Sys.time()
library(SGSeq)
path <- system.file("extdata", package = "SGSeq")
si$file_bam <- file.path(path, "bams", si$file_bam)
gr
si
txf <- predictTxFeatures(si, gr)
From<-c(rep("",3),rep("Significant",3),rep("Non Significant",3),rep("Dubious",3),"Significant ","Non Significant ","Dubious ")
To<-c("Significant","Non Significant","Dubious",rep(c("Significant ","Non Significant ","Dubious "),3),rep(" ",3))
Weight<-c(3359,20282,5027,1324,52,148,156,2444,378,183,412,292,9225,16113,5068)
EventGroups<-data.frame(From=From,To=To,Weight=Weight)
#lightblue, lightgreen, lightred, lightorange, lightpurple, lightyellow, darkbklue, darkgreen
ColorsSankeyNode<-c('#a6cee3', '#b2df8a', '#ed9136', '#f4f06e','#cab2d6', '#ffff99', '#1f78b4', '#33a02c','#c41f1f')
ColorsSankeyNode<-ColorsSankeyNode[c(7,2,4,3,2,4,3,9)]
ColorsSankeyNode <- paste0("[", paste0("'", ColorsSankeyNode,"'", collapse = ','), "]")
ColorsSankeyLink<-"#fb9a99"
ColorsSankeyLink <- paste0("[", paste0("'", ColorsSankeyLink,"'", collapse = ','), "]")
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ,"},
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
library(googleVis)
From<-c(rep("",3),rep("Significant",3),rep("Non Significant",3),rep("Dubious",3),"Significant ","Non Significant ","Dubious ")
To<-c("Significant","Non Significant","Dubious",rep(c("Significant ","Non Significant ","Dubious "),3),rep(" ",3))
Weight<-c(3359,20282,5027,1324,52,148,156,2444,378,183,412,292,9225,16113,5068)
EventGroups<-data.frame(From=From,To=To,Weight=Weight)
#lightblue, lightgreen, lightred, lightorange, lightpurple, lightyellow, darkbklue, darkgreen
ColorsSankeyNode<-c('#a6cee3', '#b2df8a', '#ed9136', '#f4f06e','#cab2d6', '#ffff99', '#1f78b4', '#33a02c','#c41f1f')
ColorsSankeyNode<-ColorsSankeyNode[c(7,2,4,3,2,4,3,9)]
ColorsSankeyNode <- paste0("[", paste0("'", ColorsSankeyNode,"'", collapse = ','), "]")
ColorsSankeyLink<-"#fb9a99"
ColorsSankeyLink <- paste0("[", paste0("'", ColorsSankeyLink,"'", collapse = ','), "]")
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ,"},
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
library(rtracklayer)
library(GenomicAlignments)
library(SRAdb)
library(Matrix)
source("C:/Users/jpromero/Desktop/Rcodes/2016/ProspliceMatching.R")
## Arrays > 25 & RNASeq alpha = 2 (Normal Match Criterion)
# Some genomic positions for start are larger than for end (in negative strand genes, mainly).
# I run the command line
# awk -F'\t' '$4 > $5 { $0 = $1 FS $2 FS $3 FS $5 FS $4 FS $6 FS $7 FS $8 FS $9} 1' paths.gtf > paths_Arrays.gtf
HTAfile<-"Y:/JuanPablo/Prosplice/Arrays/paths_Arrays.resorted.sorted.gtf"
RNAfile<-"Y:/JuanPablo/Prosplice/RNASeq/paths_RNASeq.sorted.gtf"
load("Y:/JuanPablo/Prosplice/Arrays/EventsArrays.Rdata")
load("Y:/JuanPablo/Prosplice/RNASeq/EventsRNASeq.Rdata")
Prosplice_Matching<-ProspliceMatching(HTAfile,RNAfile,"Normal",Events_HTA_Prosplice,Events_RNA_Prosplice)
Type_HTA<-table(Events_HTA_Prosplice[,"Event Type"])
Type_RNA<-table(Events_RNASeq_Prosplice[,"Event_Type"])
Info<-rbind(cbind(names(Type_HTA),Type_HTA,rep("HTA",8)),cbind(names(Type_RNA),Type_RNA,rep("RNASeq",8)))
rownames(Info)<-NULL
colnames(Info)<-c("Type","Number","Technology")
Info<-data.frame(Type=Info[,1],Number=as.numeric(Info[,2]),Technology=Info[,3],stringsAsFactors = F)
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+geom_bar(stat="identity",position="dodge")+coord_flip()+scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+scale_y_continuous(limits=c(0,15000))+theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
library(ggplot2)
Type_HTA<-table(Events_HTA_Prosplice[,"Event Type"])
Type_RNA<-table(Events_RNASeq_Prosplice[,"Event_Type"])
Info<-rbind(cbind(names(Type_HTA),Type_HTA,rep("HTA",8)),cbind(names(Type_RNA),Type_RNA,rep("RNASeq",8)))
rownames(Info)<-NULL
colnames(Info)<-c("Type","Number","Technology")
Info<-data.frame(Type=Info[,1],Number=as.numeric(Info[,2]),Technology=Info[,3],stringsAsFactors = F)
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+geom_bar(stat="identity",position="dodge")+coord_flip()+scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+scale_y_continuous(limits=c(0,15000))+theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+geom_bar(stat="identity",position="dodge")+coord_flip()+scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+scale_y_continuous(limits=c(0,15000))+theme(legend.text=element_text(face="bold",size=15),legend.justification=c(1,0),legend.position=c(1,0),legend.key.size=unit(1,"cm"),title=element_text(size=15))
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+geom_bar(stat="identity",position="dodge")+coord_flip()+scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+scale_y_continuous(limits=c(0,15000))+theme(legend.text=element_text(face="bold",size=15),legend.background = element_rect(),legend.justification=c(1,0),legend.position=c(1,0),legend.key.size=unit(1,"cm"),title=element_text(size=15))
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+geom_bar(stat="identity",position="dodge")+coord_flip()+scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+scale_y_continuous(limits=c(0,15000))+theme(legend.text=element_text(face="bold",size=15),legend.justification=c(1,0),legend.position=c(1,0),legend.key.size=unit(1,"cm"),title=element_text(size=15))+theme_set(theme_gray() + theme(legend.key=element_blank()))
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+geom_bar(stat="identity",position="dodge")+coord_flip()+scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+scale_y_continuous(limits=c(0,15000))+theme(legend.text=element_text(face="bold",size=15),legend.justification=c(1,0),legend.position=c(1,0),legend.key.size=unit(1,"cm"),title=element_text(size=15))
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
Type_HTA<-table(Events_HTA_Prosplice[,"Event Type"])
Type_RNA<-table(Events_RNASeq_Prosplice[,"Event_Type"])
Info<-rbind(cbind(names(Type_HTA),Type_HTA,rep("HTA",8)),cbind(names(Type_RNA),Type_RNA,rep("RNASeq",8)))
rownames(Info)<-NULL
colnames(Info)<-c("Type","Number","Technology")
Info<-data.frame(Type=Info[,1],Number=as.numeric(Info[,2]),Technology=Info[,3],stringsAsFactors = F)
head(Info)
which(Info$Technology=="HTA")
Info[which(Info$Technology=="HTA"),"Technology"]
Info[which(Info$Technology=="HTA"),"Technology"]<-"Arrays"
Info
Type_HTA<-table(Events_HTA_Prosplice[,"Event Type"])
Type_RNA<-table(Events_RNASeq_Prosplice[,"Event_Type"])
Info<-rbind(cbind(names(Type_HTA),Type_HTA,rep("HTA",8)),cbind(names(Type_RNA),Type_RNA,rep("RNASeq",8)))
rownames(Info)<-NULL
colnames(Info)<-c("Type","Number","Technology")
Info<-data.frame(Type=Info[,1],Number=as.numeric(Info[,2]),Technology=Info[,3],stringsAsFactors = F)
Info[which(Info$Technology=="HTA"),"Technology"]<-"Arrays"
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
Type_HTA<-table(Events_HTA_Prosplice[,"Event Type"])
Type_RNA<-table(Events_RNASeq_Prosplice[,"Event_Type"])
Info<-rbind(cbind(names(Type_HTA),Type_HTA,rep("HTA",8)),cbind(names(Type_RNA),Type_RNA,rep("RNASeq",8)))
rownames(Info)<-NULL
colnames(Info)<-c("Type","Number","Technology")
Info<-data.frame(Type=Info[,1],Number=as.numeric(Info[,2]),Technology=Info[,3],stringsAsFactors = F)
Info[which(Info$Technology=="HTA"),"Technology"]<-"Arrays"
colnames(Info)<-c("Type of Event","Number","Technology")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
ggplot(data=Info,aes(x='Type of Event',y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
ggplot(data=Info,aes(x=Info[,1],y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
ggplot(data=Info,aes(x=Type of Event,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
Type_HTA<-table(Events_HTA_Prosplice[,"Event Type"])
Type_RNA<-table(Events_RNASeq_Prosplice[,"Event_Type"])
Info<-rbind(cbind(names(Type_HTA),Type_HTA,rep("HTA",8)),cbind(names(Type_RNA),Type_RNA,rep("RNASeq",8)))
rownames(Info)<-NULL
colnames(Info)<-c("Type","Number","Technology")
Info<-data.frame(Type=Info[,1],Number=as.numeric(Info[,2]),Technology=Info[,3],stringsAsFactors = F)
Info[which(Info$Technology=="HTA"),"Technology"]<-"Arrays"
colnames(Info)<-c("EventType","Number","Technology")
ggplot(data=Info,aes(x=EventType,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
Type_HTA<-table(Events_HTA_Prosplice[,"Event Type"])
Type_RNA<-table(Events_RNASeq_Prosplice[,"Event_Type"])
Info<-rbind(cbind(names(Type_HTA),Type_HTA,rep("HTA",8)),cbind(names(Type_RNA),Type_RNA,rep("RNASeq",8)))
rownames(Info)<-NULL
colnames(Info)<-c("Type","Number","Technology")
Info<-data.frame(Type=Info[,1],Number=as.numeric(Info[,2]),Technology=Info[,3],stringsAsFactors = F)
Info[which(Info$Technology=="HTA"),"Technology"]<-"Arrays"
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15))+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),element_text(face="bold"))+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text())+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=10)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text())+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=8)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text())+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=5)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text())+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=5)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text(size=8))+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=5)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text(size=10))+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=5)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text(size=10))+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=5)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text(face="bold",size=10))+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=5)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text(face="bold",size=14))+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=5)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text(size=14))+
xlab("Type of Event")
ggplot(data=Info,aes(x=Type,y=Number,fill=Technology))+
geom_bar(stat="identity",position="dodge")+
coord_flip()+
scale_fill_manual(values=c("#14469a","#990000"))+
geom_text(aes(label=Number,hjust=-0.2),position=position_dodge(width=0.9),size=6)+
scale_y_continuous(limits=c(0,15000))+
theme(legend.text=element_text(face="bold",size=15),legend.key.size=unit(1,"cm"),title=element_text(size=15),axis.text=element_text(size=16))+
xlab("Type of Event")
From<-c(rep("",3),rep("Significant",3),rep("Non Significant",3),rep("Dubious",3),"Significant ","Non Significant ","Dubious ")
To<-c("Significant","Non Significant","Dubious",rep(c("Significant ","Non Significant ","Dubious "),3),rep(" ",3))
Weight<-c(3359,20282,5027,1324,52,148,156,2444,378,183,412,292,9225,16113,5068)
EventGroups<-data.frame(From=From,To=To,Weight=Weight)
#lightblue, lightgreen, lightred, lightorange, lightpurple, lightyellow, darkbklue, darkgreen
ColorsSankeyNode<-c('#a6cee3', '#b2df8a', '#ed9136', '#f4f06e','#cab2d6', '#ffff99', '#1f78b4', '#33a02c','#c41f1f')
ColorsSankeyNode<-ColorsSankeyNode[c(7,2,4,3,2,4,3,9)]
ColorsSankeyNode <- paste0("[", paste0("'", ColorsSankeyNode,"'", collapse = ','), "]")
ColorsSankeyLink<-"#fb9a99"
ColorsSankeyLink <- paste0("[", paste0("'", ColorsSankeyLink,"'", collapse = ','), "]")
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ,"},
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
From<-c(rep("",3),rep("Significant",3),rep("Non Significant",3),rep("Debatable",3),"Significant ","Non Significant ","Debatable ")
To<-c("Significant","Non Significant","Debatable",rep(c("Significant ","Non Significant ","Debatable "),3),rep(" ",3))
Weight<-c(3359,20282,5027,1324,52,148,156,2444,378,183,412,292,9225,16113,5068)
EventGroups<-data.frame(From=From,To=To,Weight=Weight)
#lightblue, lightgreen, lightred, lightorange, lightpurple, lightyellow, darkbklue, darkgreen
ColorsSankeyNode<-c('#a6cee3', '#b2df8a', '#ed9136', '#f4f06e','#cab2d6', '#ffff99', '#1f78b4', '#33a02c','#c41f1f')
ColorsSankeyNode<-ColorsSankeyNode[c(7,2,4,3,2,4,3,9)]
ColorsSankeyNode <- paste0("[", paste0("'", ColorsSankeyNode,"'", collapse = ','), "]")
ColorsSankeyLink<-"#fb9a99"
ColorsSankeyLink <- paste0("[", paste0("'", ColorsSankeyLink,"'", collapse = ','), "]")
opts <- paste0("{
link: { colorMode: 'gradient',
colors: ", ColorsSankeyNode ," },
node: { colors: ", ColorsSankeyNode ,"},
iterations:0,
}" )
EventGroups<-EventGroups[c(1,3,2,4,6,5,7:15),]
sk2 <- gvisSankey(EventGroups, from="From", to="To", weight="Weight",options = list(sankey=opts,width=350))
plot(sk2)
library(roxygen2)
roxygenise()
library(roxygen2)
setwd("Y:/BACKUP_GRUPO/JuanPabloRomero/EventPointer_Bioconductor/EventPointer/")
roxygenise()
